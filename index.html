<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Paw</title>
    <link rel="stylesheet" href="/src/styles.css" />
  </head>
  <body>
    <div class="app">
      <!-- Sidebar -->
      <aside class="sidebar">
        <div class="sidebar-header">
          <div class="sidebar-brand">
            <div class="sidebar-logo">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>
              </svg>
            </div>
            <span class="sidebar-title">Paw</span>
          </div>
        </div>
        
        <nav class="sidebar-nav">
          <div class="nav-section">
            <div class="nav-item active" data-view="dashboard">
              <svg class="icon" viewBox="0 0 24 24">
                <rect x="3" y="3" width="7" height="7" rx="1"/>
                <rect x="14" y="3" width="7" height="7" rx="1"/>
                <rect x="3" y="14" width="7" height="7" rx="1"/>
                <rect x="14" y="14" width="7" height="7" rx="1"/>
              </svg>
              <span>Home</span>
            </div>
            <div class="nav-item" data-view="chat">
              <svg class="icon" viewBox="0 0 24 24">
                <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
              </svg>
              <span>Chat</span>
            </div>
          </div>

          <div class="nav-section">
            <div class="nav-section-label">Create</div>
            <div class="nav-item" data-view="build">
              <svg class="icon" viewBox="0 0 24 24">
                <polyline points="16 18 22 12 16 6"/>
                <polyline points="8 6 2 12 8 18"/>
                <line x1="14" y1="4" x2="10" y2="20"/>
              </svg>
              <span>Build</span>
              <span class="nav-badge">New</span>
            </div>
            <div class="nav-item" data-view="code">
              <svg class="icon" viewBox="0 0 24 24">
                <circle cx="12" cy="12" r="3"/>
                <path d="M12 1v4M12 19v4M4.22 4.22l2.83 2.83M16.95 16.95l2.83 2.83M1 12h4M19 12h4M4.22 19.78l2.83-2.83M16.95 7.05l2.83-2.83"/>
              </svg>
              <span>Code</span>
            </div>
            <div class="nav-item" data-view="content">
              <svg class="icon" viewBox="0 0 24 24">
                <path d="M12 20h9"/>
                <path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"/>
              </svg>
              <span>Create</span>
            </div>
          </div>

          <div class="nav-section">
            <div class="nav-section-label">Automate</div>
            <div class="nav-item" data-view="mail">
              <svg class="icon" viewBox="0 0 24 24">
                <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
                <polyline points="22,6 12,13 2,6"/>
              </svg>
              <span>Mail</span>
              <span class="nav-badge">New</span>
            </div>
            <div class="nav-item" data-view="automations">
              <svg class="icon" viewBox="0 0 24 24">
                <polyline points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/>
              </svg>
              <span>Automate</span>
            </div>
            <div class="nav-item" data-view="channels">
              <svg class="icon" viewBox="0 0 24 24">
                <path d="M15 10l4.553-2.276A1 1 0 0 1 21 8.618v6.764a1 1 0 0 1-1.447.894L15 14"/>
                <rect x="1" y="6" width="14" height="12" rx="2"/>
              </svg>
              <span>Channels</span>
            </div>
            <div class="nav-item" data-view="research">
              <svg class="icon" viewBox="0 0 24 24">
                <circle cx="12" cy="12" r="10"/>
                <line x1="2" y1="12" x2="22" y2="12"/>
                <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/>
              </svg>
              <span>Research</span>
            </div>
          </div>
          
          <div class="nav-section">
            <div class="nav-section-label">System</div>
            <div class="nav-item" data-view="memory">
              <svg class="icon" viewBox="0 0 24 24">
                <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/>
                <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/>
              </svg>
              <span>Memory</span>
            </div>
            <div class="nav-item" data-view="skills">
              <svg class="icon" viewBox="0 0 24 24">
                <path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"/>
              </svg>
              <span>Skills</span>
            </div>
            <div class="nav-item" data-view="foundry">
              <svg class="icon" viewBox="0 0 24 24">
                <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>
                <polyline points="3.27 6.96 12 12.01 20.73 6.96"/>
                <line x1="12" y1="22.08" x2="12" y2="12"/>
              </svg>
              <span>Foundry</span>
            </div>
            <div class="nav-item" data-view="settings">
              <svg class="icon" viewBox="0 0 24 24">
                <circle cx="12" cy="12" r="3"/>
                <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/>
              </svg>
              <span>Settings</span>
            </div>
          </div>
        </nav>
        
        <div class="sidebar-footer">
          <div class="status-indicator">
            <span class="status-dot" id="status-dot"></span>
            <span id="status-text">Connecting...</span>
          </div>
        </div>
      </aside>

      <!-- Main Content -->
      <main class="main">

        <!-- ═══ Dashboard ═══ -->
        <div class="view dashboard-view" id="dashboard-view">
          <div class="dashboard-greeting">
            <h1>Welcome to Paw</h1>
            <p>Your AI command center — powered by OpenClaw</p>
          </div>

          <div class="quick-actions">
            <button class="quick-action" data-view="chat">
              <svg class="icon" viewBox="0 0 24 24"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>
              New Chat
            </button>
            <button class="quick-action" data-view="build">
              <svg class="icon" viewBox="0 0 24 24"><polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/></svg>
              Build App
            </button>
            <button class="quick-action" data-view="mail">
              <svg class="icon" viewBox="0 0 24 24"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
              Check Mail
            </button>
          </div>

          <!-- Primary Features -->
          <div class="feature-section">
            <div class="feature-section-title">Start here</div>
            <div class="feature-grid primary">
              <button class="feature-card" data-view="chat">
                <div class="feature-card-icon orange">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>
                </div>
                <div class="feature-card-title">Chat</div>
                <div class="feature-card-desc">Talk to your agent — ask anything, get answers, run tasks</div>
              </button>

              <button class="feature-card" data-view="build">
                <div class="feature-card-icon blue">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/><line x1="14" y1="4" x2="10" y2="20"/></svg>
                </div>
                <div class="feature-card-title">Build</div>
                <div class="feature-card-desc">Describe an app and watch it get built — frontend, backend, deployed</div>
                <span class="feature-card-tag new">New</span>
              </button>

              <button class="feature-card" data-view="code">
                <div class="feature-card-icon purple">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><circle cx="12" cy="12" r="3"/><path d="M12 1v4M12 19v4M4.22 4.22l2.83 2.83M16.95 16.95l2.83 2.83M1 12h4M19 12h4M4.22 19.78l2.83-2.83M16.95 7.05l2.83-2.83"/></svg>
                </div>
                <div class="feature-card-title">Code</div>
                <div class="feature-card-desc">Git repos, branches, PRs, code review — managed by your agent</div>
              </button>
            </div>
          </div>

          <!-- Productivity -->
          <div class="feature-section">
            <div class="feature-section-title">Productivity</div>
            <div class="feature-grid secondary">
              <button class="feature-card" data-view="mail">
                <div class="feature-card-icon pink">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
                </div>
                <div class="feature-card-title">Mail</div>
                <div class="feature-card-desc">Read, draft and send emails with approval guardrails</div>
                <span class="feature-card-tag new">New</span>
              </button>

              <button class="feature-card" data-view="automations">
                <div class="feature-card-icon yellow">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><polyline points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>
                </div>
                <div class="feature-card-title">Automate</div>
                <div class="feature-card-desc">Scheduled tasks, triggers, and recurring workflows</div>
              </button>

              <button class="feature-card" data-view="research">
                <div class="feature-card-icon cyan">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><circle cx="12" cy="12" r="10"/><line x1="2" y1="12" x2="22" y2="12"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/></svg>
                </div>
                <div class="feature-card-title">Research</div>
                <div class="feature-card-desc">Browse the web, find data, compile reports automatically</div>
                <span class="feature-card-tag beta">Beta</span>
              </button>

              <button class="feature-card" data-view="content">
                <div class="feature-card-icon green">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M12 20h9"/><path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"/></svg>
                </div>
                <div class="feature-card-title">Create</div>
                <div class="feature-card-desc">Blog posts, social content, marketing copy, and more</div>
              </button>
            </div>
          </div>

          <!-- Connect & System -->
          <div class="feature-section">
            <div class="feature-section-title">Connect & Configure</div>
            <div class="feature-grid system">
              <button class="feature-card" data-view="channels">
                <div class="feature-card-icon orange">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M15 10l4.553-2.276A1 1 0 0 1 21 8.618v6.764a1 1 0 0 1-1.447.894L15 14"/><rect x="1" y="6" width="14" height="12" rx="2"/></svg>
                </div>
                <div class="feature-card-title">Channels</div>
                <div class="feature-card-desc">Telegram, Discord, WhatsApp, Signal</div>
              </button>

              <button class="feature-card" data-view="memory">
                <div class="feature-card-icon purple">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/></svg>
                </div>
                <div class="feature-card-title">Memory</div>
                <div class="feature-card-desc">Persistent knowledge that grows over time</div>
              </button>

              <button class="feature-card" data-view="skills">
                <div class="feature-card-icon cyan">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"/></svg>
                </div>
                <div class="feature-card-title">Skills</div>
                <div class="feature-card-desc">Install and manage agent abilities</div>
              </button>

              <button class="feature-card" data-view="foundry">
                <div class="feature-card-icon yellow">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/><polyline points="3.27 6.96 12 12.01 20.73 6.96"/><line x1="12" y1="22.08" x2="12" y2="12"/></svg>
                </div>
                <div class="feature-card-title">Foundry</div>
                <div class="feature-card-desc">Choose models and manage your subscription</div>
                <span class="feature-card-tag pro">Pro</span>
              </button>
            </div>
          </div>

          <!-- Scheduled Tasks Widget -->
          <div class="feature-section" id="dashboard-cron-section" style="display:none">
            <div class="feature-section-title">
              <svg class="icon-sm" viewBox="0 0 24 24" style="display:inline;vertical-align:-2px;margin-right:4px"><polyline points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>
              Scheduled Tasks
            </div>
            <div class="dash-cron-grid" id="dashboard-cron-list"></div>
            <div class="dash-cron-empty" id="dashboard-cron-empty" style="display:none">
              <span>No scheduled tasks running.</span>
              <button class="btn btn-ghost btn-sm" data-view="automations">Set up automations →</button>
            </div>
          </div>
        </div>

        <!-- ═══ Onboarding ═══ -->
        <div class="view setup-view" id="setup-view">
          <div class="setup-card">
            <div class="setup-header">
              <div class="setup-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                  <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>
                </svg>
              </div>
              <h1 class="setup-title">Welcome to Paw</h1>
              <p class="setup-subtitle">Connect to your OpenClaw gateway or set up a new one</p>
            </div>
            
            <div class="setup-options">
              <button class="setup-option" id="setup-detect">
                <div class="setup-option-icon">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/>
                  </svg>
                </div>
                <div class="setup-option-text">
                  <div class="setup-option-title">Detect Existing</div>
                  <div class="setup-option-desc">Find a running gateway on this machine</div>
                </div>
              </button>
              
              <button class="setup-option" id="setup-manual">
                <div class="setup-option-icon">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
                    <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
                  </svg>
                </div>
                <div class="setup-option-text">
                  <div class="setup-option-title">Manual Setup</div>
                  <div class="setup-option-desc">Enter gateway URL and token</div>
                </div>
              </button>
              
              <button class="setup-option" id="setup-new">
                <div class="setup-option-icon">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <circle cx="12" cy="12" r="10"/>
                    <line x1="12" y1="8" x2="12" y2="16"/>
                    <line x1="8" y1="12" x2="16" y2="12"/>
                  </svg>
                </div>
                <div class="setup-option-text">
                  <div class="setup-option-title">New Setup</div>
                  <div class="setup-option-desc">Install and configure OpenClaw</div>
                </div>
              </button>
            </div>
          </div>
        </div>

        <!-- ═══ Install View ═══ -->
        <div class="view setup-view" id="install-view">
          <div class="setup-card">
            <div class="setup-header">
              <div class="setup-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                  <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                  <polyline points="7 10 12 15 17 10"/>
                  <line x1="12" y1="15" x2="12" y2="3"/>
                </svg>
              </div>
              <h1 class="setup-title">Install OpenClaw</h1>
              <p class="setup-subtitle">We'll download and set up everything for you</p>
            </div>
            
            <div class="install-requirements">
              <div class="requirement-item" id="req-node">
                <svg class="icon-sm" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/></svg>
                <span>Node.js runtime</span>
              </div>
              <div class="requirement-item">
                <svg class="icon-sm" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/></svg>
                <span>OpenClaw gateway</span>
              </div>
            </div>
            
            <div class="install-progress">
              <div class="progress-bar"><div class="progress-fill" id="install-progress-bar"></div></div>
              <p class="progress-text" id="install-progress-text">Ready to install</p>
            </div>
            
            <div class="btn-group">
              <button type="button" class="btn btn-secondary" id="install-back">Back</button>
              <button type="button" class="btn btn-primary" id="start-install">Install Now</button>
            </div>
          </div>
        </div>

        <!-- ═══ Manual Config ═══ -->
        <div class="view setup-view" id="manual-setup-view">
          <div class="setup-card">
            <div class="setup-header">
              <div class="setup-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                  <rect x="2" y="3" width="20" height="14" rx="2"/>
                  <line x1="8" y1="21" x2="16" y2="21"/>
                  <line x1="12" y1="17" x2="12" y2="21"/>
                </svg>
              </div>
              <h1 class="setup-title">Gateway Configuration</h1>
              <p class="setup-subtitle">Enter your OpenClaw gateway details</p>
            </div>
            
            <form id="gateway-form">
              <div class="form-group">
                <label class="form-label">Gateway URL</label>
                <input type="text" class="form-input" id="gateway-url" value="" placeholder="http://localhost:18789" />
              </div>
              <div class="form-group">
                <label class="form-label">Auth Token</label>
                <input type="password" class="form-input" id="gateway-token" placeholder="Enter token from openclaw.json" />
                <p class="form-hint">Find this in ~/.openclaw/openclaw.json under gateway.auth.token</p>
              </div>
              <div class="btn-group">
                <button type="button" class="btn btn-secondary" id="gateway-back">Back</button>
                <button type="submit" class="btn btn-primary">Connect</button>
              </div>
            </form>
          </div>
        </div>


        <!-- ═══ Chat View ═══ -->
        <div class="view chat-view" id="chat-view">
          <div class="chat-header">
            <div class="chat-header-left">
              <div class="chat-avatar">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                  <circle cx="12" cy="8" r="5"/><path d="M20 21a8 8 0 1 0-16 0"/>
                </svg>
              </div>
              <div>
                <div class="chat-title" id="chat-agent-name">Agent</div>
                <div class="chat-subtitle" id="model-label">Connected</div>
              </div>
            </div>
            <div style="display:flex;gap:6px;align-items:center">
              <select class="chat-session-select" id="chat-session-select" title="Switch session"></select>
              <button class="btn btn-ghost" id="new-chat-btn" title="New Chat">
                <svg class="icon" viewBox="0 0 24 24">
                  <line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/>
                </svg>
              </button>
            </div>
          </div>
          
          <div class="chat-messages" id="chat-messages">
            <div class="empty-state" id="chat-empty">
              <div class="empty-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                  <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
                </svg>
              </div>
              <div class="empty-title">Start a conversation</div>
              <div class="empty-subtitle">Ask anything — your agent is ready</div>
            </div>
          </div>
          
          <div class="chat-input-container">
            <div class="chat-input-wrapper">
              <textarea class="chat-input" id="chat-input" placeholder="Message your agent..." rows="1"></textarea>
              <button class="chat-send" id="chat-send">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <line x1="22" y1="2" x2="11" y2="13"/>
                  <polygon points="22 2 15 22 11 13 2 9 22 2"/>
                </svg>
              </button>
            </div>
          </div>
        </div>

        <!-- ═══ Build View — IDE Layout ═══ -->
        <div class="view ide-view" id="build-view">
          <div class="ide-toolbar">
            <div class="ide-toolbar-left">
              <select class="ide-project-select" id="build-project-select" title="Select project">
                <option value="">No project</option>
              </select>
              <button class="btn btn-ghost btn-sm" id="build-new-project">
                <svg class="icon-sm" viewBox="0 0 24 24"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
                New Project
              </button>
            </div>
            <div class="ide-toolbar-right">
              <button class="btn btn-ghost btn-sm" id="build-run-btn" title="Run">
                <svg class="icon-sm" viewBox="0 0 24 24"><polygon points="5 3 19 12 5 21 5 3"/></svg>
                Run
              </button>
            </div>
          </div>
          <div class="ide-body">
            <div class="ide-sidebar" id="build-file-tree">
              <div class="ide-sidebar-header">
                <span>Files</span>
                <button class="btn-icon" id="build-add-file" title="New file">
                  <svg class="icon-sm" viewBox="0 0 24 24"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
                </button>
              </div>
              <div class="ide-file-list" id="build-file-list">
                <div class="ide-file-empty">No files yet</div>
              </div>
            </div>
            <div class="ide-editor-area">
              <div class="ide-tabs" id="build-tabs"></div>
              <div class="ide-editor" id="build-editor-container">
                <div class="empty-state" id="build-empty">
                  <div class="empty-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/></svg></div>
                  <div class="empty-title">Start building</div>
                  <div class="empty-subtitle">Create a new project or open an existing one</div>
                </div>
                <textarea class="ide-code-editor" id="build-code-editor" style="display:none" spellcheck="false"></textarea>
              </div>
              <div class="ide-terminal" id="build-terminal" style="display:none">
                <div class="ide-terminal-header">
                  <span>Output</span>
                  <button class="btn-icon" id="build-terminal-close">✕</button>
                </div>
                <pre class="ide-terminal-content" id="build-terminal-content"></pre>
              </div>
            </div>
            <div class="ide-chat-sidebar" id="build-chat-panel">
              <div class="ide-chat-header">
                <span>Agent</span>
                <button class="btn-icon" id="build-chat-toggle" title="Toggle chat">
                  <svg class="icon-sm" viewBox="0 0 24 24"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>
                </button>
              </div>
              <div class="ide-chat-messages" id="build-chat-messages">
                <div class="ide-chat-hint">Describe what you want to build and the agent will write the code.</div>
              </div>
              <div class="ide-chat-input-area">
                <textarea class="ide-chat-input" id="build-chat-input" placeholder="Describe what to build..." rows="2"></textarea>
                <button class="btn btn-primary btn-sm" id="build-chat-send">Send</button>
              </div>
              <!-- Build scheduled tasks -->
              <div class="space-cron-widget" id="build-cron-widget" style="display:none">
                <div class="space-cron-header">
                  <svg class="icon-sm" viewBox="0 0 24 24"><polyline points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>
                  <span>Scheduled</span>
                  <span class="space-cron-count" id="build-cron-count">0</span>
                </div>
                <div class="space-cron-items" id="build-cron-items"></div>
              </div>
            </div>
          </div>
        </div>

        <!-- ═══ Code View — Git & Repos ═══ -->
        <div class="view list-view" id="code-view">
          <div class="view-header">
            <h1 class="view-title">Code</h1>
            <div style="display:flex;gap:6px">
              <button class="btn btn-ghost btn-sm" id="code-refresh-btn">
                <svg class="icon-sm" viewBox="0 0 24 24"><polyline points="23 4 23 10 17 10"/><polyline points="1 20 1 14 7 14"/><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/></svg>
                Refresh
              </button>
            </div>
          </div>
          <div class="code-actions-bar">
            <button class="btn btn-primary btn-sm" id="code-new-repo">
              <svg class="icon-sm" viewBox="0 0 24 24"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
              New Repo
            </button>
            <button class="btn btn-secondary btn-sm" id="code-clone-repo">Clone</button>
          </div>
          <div class="list-content" id="code-repo-list"></div>
          <div class="empty-state" id="code-empty">
            <div class="empty-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><circle cx="12" cy="12" r="3"/><path d="M12 1v4M12 19v4"/></svg></div>
            <div class="empty-title">Git & code management</div>
            <div class="empty-subtitle">Create repos, manage branches, review PRs — all through your agent</div>
          </div>
        </div>

        <!-- ═══ Content View — Create Studio ═══ -->
        <div class="view studio-view" id="content-view">
          <div class="studio-sidebar">
            <div class="studio-sidebar-header">
              <span class="studio-sidebar-title">Documents</span>
              <button class="btn-icon" id="content-new-doc" title="New document">
                <svg class="icon-sm" viewBox="0 0 24 24"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
              </button>
            </div>
            <div class="studio-doc-list" id="content-doc-list">
              <div class="studio-doc-empty">No documents yet</div>
            </div>
          </div>
          <div class="studio-main">
            <div class="studio-toolbar" id="content-toolbar" style="display:none">
              <input class="studio-title-input" id="content-title" placeholder="Untitled document" />
              <div class="studio-toolbar-actions">
                <select class="studio-type-select" id="content-type">
                  <option value="markdown">Markdown</option>
                  <option value="html">HTML</option>
                  <option value="plaintext">Plain Text</option>
                </select>
                <button class="btn btn-ghost btn-sm" id="content-ai-improve" title="AI improve">
                  <svg class="icon-sm" viewBox="0 0 24 24"><path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/></svg>
                  AI Improve
                </button>
                <button class="btn btn-primary btn-sm" id="content-save">Save</button>
                <button class="btn btn-ghost btn-sm btn-error" id="content-delete-doc" title="Delete document">Delete</button>
              </div>
            </div>
            <div class="studio-editor" id="content-editor-area">
              <div class="empty-state" id="content-empty">
                <div class="empty-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M12 20h9"/><path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"/></svg></div>
                <div class="empty-title">Content studio</div>
                <div class="empty-subtitle">Create blog posts, marketing copy, documentation — with AI assistance</div>
                <button class="btn btn-primary" id="content-create-first" style="margin-top:16px">Create Document</button>
              </div>
              <textarea class="studio-content-editor" id="content-body" style="display:none" placeholder="Start writing..."></textarea>
            </div>
            <div class="studio-word-count" id="content-word-count" style="display:none">0 words</div>
            <!-- Content scheduled tasks -->
            <div class="space-cron-widget space-cron-widget-inline" id="content-cron-widget" style="display:none">
              <div class="space-cron-header">
                <svg class="icon-sm" viewBox="0 0 24 24"><polyline points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>
                <span>Publishing schedule</span>
                <span class="space-cron-count" id="content-cron-count">0</span>
              </div>
              <div class="space-cron-items" id="content-cron-items"></div>
            </div>
          </div>
        </div>

        <!-- ═══ Mail View — Email Client ═══ -->
        <div class="view mail-client-view" id="mail-view">
          <div class="mail-sidebar">
            <div class="mail-sidebar-header">
              <button class="btn btn-primary btn-sm mail-compose-btn" id="mail-compose">
                <svg class="icon-sm" viewBox="0 0 24 24"><path d="M12 20h9"/><path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"/></svg>
                Compose
              </button>
            </div>
            <div class="mail-folders">
              <div class="mail-folder active" data-folder="inbox">
                <svg class="icon-sm" viewBox="0 0 24 24"><polyline points="22 12 16 12 14 15 10 15 8 12 2 12"/><path d="M5.45 5.11L2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z"/></svg>
                <span>Inbox</span>
                <span class="mail-count" id="mail-inbox-count">0</span>
              </div>
              <div class="mail-folder" data-folder="drafts">
                <svg class="icon-sm" viewBox="0 0 24 24"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/></svg>
                <span>Drafts</span>
              </div>
              <div class="mail-folder" data-folder="sent">
                <svg class="icon-sm" viewBox="0 0 24 24"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>
                <span>Sent</span>
              </div>
              <div class="mail-folder" data-folder="agent">
                <svg class="icon-sm" viewBox="0 0 24 24"><path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/></svg>
                <span>Agent Drafts</span>
                <span class="mail-count mail-count-accent" id="mail-agent-count">0</span>
              </div>
            </div>
            <div class="mail-accounts-section">
              <div class="mail-accounts-header">Accounts</div>
              <div id="mail-accounts-list">
                <div class="mail-no-accounts">No accounts connected</div>
              </div>
              <button class="btn btn-ghost btn-sm" id="mail-add-account" style="width:100%;margin-top:8px">
                <svg class="icon-sm" viewBox="0 0 24 24"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
                Add Account
              </button>
            </div>
            <!-- Mail scheduled tasks -->
            <div class="space-cron-widget space-cron-widget-sidebar" id="mail-cron-widget" style="display:none">
              <div class="space-cron-header">
                <svg class="icon-sm" viewBox="0 0 24 24"><polyline points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>
                <span>Digests</span>
                <span class="space-cron-count" id="mail-cron-count">0</span>
              </div>
              <div class="space-cron-items" id="mail-cron-items"></div>
            </div>
          </div>
          <div class="mail-list" id="mail-message-list">
            <div class="mail-list-header">
              <span class="mail-list-title" id="mail-folder-title">Inbox</span>
              <button class="btn btn-ghost btn-sm" id="mail-refresh">
                <svg class="icon-sm" viewBox="0 0 24 24"><polyline points="23 4 23 10 17 10"/><polyline points="1 20 1 14 7 14"/><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/></svg>
              </button>
            </div>
            <div class="mail-items" id="mail-items"></div>
            <div class="empty-state" id="mail-empty">
              <div class="empty-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg></div>
              <div class="empty-title">Connect your email</div>
              <div class="empty-subtitle">Add an IMAP/SMTP account to read, draft, and send emails with AI assistance</div>
              <button class="btn btn-primary" id="mail-setup-account" style="margin-top:16px">Add Email Account</button>
            </div>
          </div>
          <div class="mail-preview" id="mail-preview">
            <div class="mail-preview-empty">Select an email to read</div>
          </div>
        </div>

        <!-- ═══ Automations View — Card Board ═══ -->
        <div class="view auto-view" id="automations-view">
          <div class="view-header">
            <h1 class="view-title">Automations</h1>
            <div style="display:flex;gap:6px">
              <button class="btn btn-ghost btn-sm" id="cron-view-toggle" title="Toggle view">
                <svg class="icon-sm" viewBox="0 0 24 24"><rect x="3" y="3" width="7" height="7" rx="1"/><rect x="14" y="3" width="7" height="7" rx="1"/><rect x="3" y="14" width="7" height="7" rx="1"/><rect x="14" y="14" width="7" height="7" rx="1"/></svg>
              </button>
              <button class="btn btn-primary btn-sm" id="add-cron-btn">
                <svg class="icon-sm" viewBox="0 0 24 24"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
                New Automation
              </button>
            </div>
          </div>
          <div class="auto-board">
            <div class="auto-column">
              <div class="auto-column-header">
                <span class="auto-column-dot active"></span>
                <span>Active</span>
                <span class="auto-column-count" id="cron-active-count">0</span>
              </div>
              <div class="auto-column-cards" id="cron-active-cards"></div>
            </div>
            <div class="auto-column">
              <div class="auto-column-header">
                <span class="auto-column-dot paused"></span>
                <span>Paused</span>
                <span class="auto-column-count" id="cron-paused-count">0</span>
              </div>
              <div class="auto-column-cards" id="cron-paused-cards"></div>
            </div>
            <div class="auto-column">
              <div class="auto-column-header">
                <span class="auto-column-dot history"></span>
                <span>Run History</span>
              </div>
              <div class="auto-column-cards" id="cron-history-cards"></div>
            </div>
          </div>
          <div class="empty-state" id="cron-empty">
            <div class="empty-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><polyline points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg></div>
            <div class="empty-title">No automations yet</div>
            <div class="empty-subtitle">Create scheduled tasks, triggers, and recurring workflows</div>
            <button class="btn btn-primary" id="cron-empty-add" style="margin-top:16px">Create First Automation</button>
          </div>
          <div class="view-loading" id="cron-loading" style="display:none">Loading automations…</div>
          <!-- Add/Edit Automation Modal -->
          <div class="modal-overlay" id="cron-modal" style="display:none">
            <div class="modal-card">
              <div class="modal-header">
                <h2 class="modal-title" id="cron-modal-title">New Automation</h2>
                <button class="btn-icon" id="cron-modal-close">✕</button>
              </div>
              <div class="modal-body">
                <div class="form-group">
                  <label class="form-label">Name</label>
                  <input type="text" class="form-input" id="cron-form-label" placeholder="My automation" />
                </div>
                <div class="form-group">
                  <label class="form-label">Schedule</label>
                  <select class="form-input" id="cron-form-schedule-preset">
                    <option value="">Custom cron...</option>
                    <option value="*/5 * * * *">Every 5 minutes</option>
                    <option value="*/15 * * * *">Every 15 minutes</option>
                    <option value="*/30 * * * *">Every 30 minutes</option>
                    <option value="0 * * * *">Every hour</option>
                    <option value="0 */6 * * *">Every 6 hours</option>
                    <option value="0 9 * * *">Daily at 9 AM</option>
                    <option value="0 9 * * 1">Weekly — Monday 9 AM</option>
                    <option value="0 9 1 * *">Monthly — 1st at 9 AM</option>
                  </select>
                  <input type="text" class="form-input" id="cron-form-schedule" placeholder="0 * * * *" style="margin-top:8px" />
                </div>
                <div class="form-group">
                  <label class="form-label">Task prompt</label>
                  <textarea class="form-input" id="cron-form-prompt" rows="3" placeholder="What should the agent do?"></textarea>
                </div>
              </div>
              <div class="modal-footer">
                <button class="btn btn-secondary" id="cron-modal-cancel">Cancel</button>
                <button class="btn btn-primary" id="cron-modal-save">Create</button>
              </div>
            </div>
          </div>
        </div>

        <!-- ═══ Channels View — Connection Hub ═══ -->
        <div class="view list-view" id="channels-view">
          <div class="view-header">
            <h1 class="view-title">Channels</h1>
            <button class="btn btn-ghost btn-sm" id="refresh-channels-btn">
              <svg class="icon-sm" viewBox="0 0 24 24"><polyline points="23 4 23 10 17 10"/><polyline points="1 20 1 14 7 14"/><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/></svg>
              Refresh
            </button>
          </div>
          <div class="channel-grid" id="channels-list"></div>
          <div class="empty-state" id="channels-empty">
            <div class="empty-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M15 10l4.553-2.276A1 1 0 0 1 21 8.618v6.764a1 1 0 0 1-1.447.894L15 14"/><rect x="1" y="6" width="14" height="12" rx="2"/></svg></div>
            <div class="empty-title">No channels configured</div>
            <div class="empty-subtitle">Configure channels in your openclaw.json — Telegram, Discord, WhatsApp, Signal, Slack</div>
          </div>
          <div class="view-loading" id="channels-loading" style="display:none">Loading channels…</div>
        </div>

        <!-- ═══ Research View — Notebook ═══ -->
        <div class="view studio-view" id="research-view">
          <div class="studio-sidebar">
            <div class="studio-sidebar-header">
              <span class="studio-sidebar-title">Research</span>
              <button class="btn-icon" id="research-new-project" title="New research project">
                <svg class="icon-sm" viewBox="0 0 24 24"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
              </button>
            </div>
            <div class="studio-doc-list" id="research-project-list">
              <div class="studio-doc-empty">No research projects</div>
            </div>
            <!-- Research scheduled tasks -->
            <div class="space-cron-widget space-cron-widget-sidebar" id="research-cron-widget" style="display:none">
              <div class="space-cron-header">
                <svg class="icon-sm" viewBox="0 0 24 24"><polyline points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>
                <span>Recurring</span>
                <span class="space-cron-count" id="research-cron-count">0</span>
              </div>
              <div class="space-cron-items" id="research-cron-items"></div>
            </div>
          </div>
          <div class="studio-main">
            <div class="research-tabs" id="research-tabs" style="display:none">
              <button class="research-tab active" data-tab="sources">Sources</button>
              <button class="research-tab" data-tab="findings">Findings</button>
              <button class="research-tab" data-tab="report">Report</button>
              <button class="btn btn-ghost btn-sm btn-error" id="research-delete-project" style="margin-left:auto">Delete</button>
            </div>
            <div class="studio-editor" id="research-content">
              <div class="empty-state" id="research-empty">
                <div class="empty-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><circle cx="12" cy="12" r="10"/><line x1="2" y1="12" x2="22" y2="12"/></svg></div>
                <div class="empty-title">Research notebook</div>
                <div class="empty-subtitle">Create a research project — your agent will browse the web, gather data, and compile findings</div>
                <button class="btn btn-primary" id="research-create-first" style="margin-top:16px">Start Research</button>
              </div>
              <div class="research-panel" id="research-sources" style="display:none">
                <div class="research-panel-header">
                  <h3>Sources</h3>
                  <button class="btn btn-primary btn-sm" id="research-add-source">
                    <svg class="icon-sm" viewBox="0 0 24 24"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
                    Add URL
                  </button>
                </div>
                <div id="research-sources-list" class="research-items"></div>
              </div>
              <div class="research-panel" id="research-findings" style="display:none">
                <div class="research-panel-header">
                  <h3>Findings</h3>
                  <button class="btn btn-primary btn-sm" id="research-agent-find">
                    <svg class="icon-sm" viewBox="0 0 24 24"><path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/></svg>
                    Agent Research
                  </button>
                </div>
                <div id="research-findings-list" class="research-items"></div>
              </div>
              <div class="research-panel" id="research-report" style="display:none">
                <div class="research-panel-header">
                  <h3>Report</h3>
                  <button class="btn btn-primary btn-sm" id="research-generate-report">Generate Report</button>
                </div>
                <textarea class="studio-content-editor" id="research-report-editor" placeholder="Report will appear here..."></textarea>
              </div>
            </div>
          </div>
        </div>

        <!-- ═══ Memory View — Knowledge Base ═══ -->
        <div class="view palace-view" id="memory-view">
          <!-- Memory setup banner (shown when plugin not configured) -->
          <div class="palace-install-banner" id="palace-install-banner" style="display:none">
            <div class="palace-install-card">
              <div class="palace-install-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" width="48" height="48">
                  <path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a2 2 0 0 1-2 2h-4a2 2 0 0 1-2-2v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7z"/>
                  <line x1="9" y1="21" x2="15" y2="21"/>
                  <line x1="10" y1="24" x2="14" y2="24"/>
                </svg>
              </div>
              <h2 class="palace-install-title">Enable Long-Term Memory</h2>
              <p class="palace-install-desc">
                Give your agent persistent vector memory with auto-capture and semantic recall.
                Just add an embedding API key — no extra software required.
              </p>
              <div class="palace-api-config" id="palace-api-config">
                <label class="palace-api-label" for="palace-api-key">
                  Embedding API Key <span class="palace-api-required">*</span>
                </label>
                <input class="palace-api-input" id="palace-api-key" type="password"
                  placeholder="sk-... or Azure API key" autocomplete="off" spellcheck="false" />
                <label class="palace-api-label" for="palace-base-url">
                  Custom Endpoint <span class="palace-api-hint">(Azure / Foundry — leave blank for OpenAI)</span>
                </label>
                <input class="palace-api-input" id="palace-base-url" type="text"
                  placeholder="https://your-resource.openai.azure.com/openai/deployments/text-embedding-3-small" autocomplete="off" spellcheck="false" />
                <label class="palace-api-label" for="palace-model-name">
                  Model <span class="palace-api-hint">(defaults to text-embedding-3-small)</span>
                </label>
                <input class="palace-api-input" id="palace-model-name" type="text"
                  placeholder="text-embedding-3-small" autocomplete="off" spellcheck="false" />
              </div>
              <div class="palace-install-progress" id="palace-install-progress" style="display:none">
                <p class="progress-text" id="palace-progress-text">Saving configuration…</p>
              </div>
              <div class="palace-install-actions">
                <button class="btn btn-primary" id="palace-install-btn">Enable Memory</button>
                <button class="btn btn-ghost btn-sm" id="palace-skip-btn">Skip — use file editor only</button>
              </div>
            </div>
          </div>
          <!-- Palace Sidebar -->
          <div class="palace-sidebar">
            <div class="palace-sidebar-header">
              <span class="palace-sidebar-title">Memory</span>
              <button class="btn-icon" id="palace-refresh" title="Refresh memories">
                <svg class="icon-sm" viewBox="0 0 24 24"><polyline points="23 4 23 10 17 10"/><polyline points="1 20 1 14 7 14"/><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/></svg>
              </button>
            </div>
            <!-- Stats summary -->
            <div class="palace-stats" id="palace-stats">
              <div class="palace-stat">
                <span class="palace-stat-num" id="palace-total">—</span>
                <span class="palace-stat-label">Total</span>
              </div>
              <div class="palace-stat">
                <span class="palace-stat-num" id="palace-types">—</span>
                <span class="palace-stat-label">Types</span>
              </div>
              <div class="palace-stat">
                <span class="palace-stat-num" id="palace-graph-edges">—</span>
                <span class="palace-stat-label">Links</span>
              </div>
            </div>
            <!-- Filters -->
            <div class="palace-filters">
              <input class="palace-search-input" id="palace-search" placeholder="Search memories…" />
              <select class="palace-filter-select" id="palace-type-filter">
                <option value="">All types</option>
                <option value="fact">Facts</option>
                <option value="preference">Preferences</option>
                <option value="architecture">Architecture</option>
                <option value="decision">Decisions</option>
                <option value="insight">Insights</option>
                <option value="gotcha">Gotchas</option>
                <option value="event">Events</option>
                <option value="solution">Solutions</option>
              </select>
              <select class="palace-filter-select" id="palace-project-filter">
                <option value="">All projects</option>
              </select>
            </div>
            <!-- Memory list -->
            <div class="palace-memory-list" id="palace-memory-list">
              <div class="palace-list-empty" style="padding:12px;color:var(--text-muted);font-size:0.85rem">Loading…</div>
            </div>
            <!-- Agent file fallback section -->
            <div class="palace-section-divider" id="palace-files-divider">
              <span>Agent Files</span>
              <button class="btn-icon" id="refresh-memory-btn" title="Refresh files">
                <svg class="icon-sm" viewBox="0 0 24 24"><polyline points="23 4 23 10 17 10"/><polyline points="1 20 1 14 7 14"/><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/></svg>
              </button>
            </div>
            <div class="palace-memory-list" id="memory-list"></div>
          </div>
          <!-- Palace Main -->
          <div class="palace-main">
            <!-- Tabs: Recall / Graph / Remember / Files -->
            <div class="palace-tabs">
              <button class="palace-tab active" data-palace-tab="recall">
                <svg class="icon-sm" viewBox="0 0 24 24"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>
                Recall
              </button>
              <button class="palace-tab" data-palace-tab="graph">
                <svg class="icon-sm" viewBox="0 0 24 24"><circle cx="6" cy="6" r="3"/><circle cx="18" cy="18" r="3"/><circle cx="18" cy="6" r="3"/><line x1="8.5" y1="7.5" x2="15.5" y2="16.5"/><line x1="15.5" y1="7.5" x2="8.5" y2="16.5"/></svg>
                Map
              </button>
              <button class="palace-tab" data-palace-tab="remember">
                <svg class="icon-sm" viewBox="0 0 24 24"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
                Remember
              </button>
              <button class="palace-tab" data-palace-tab="files">
                <svg class="icon-sm" viewBox="0 0 24 24"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/></svg>
                Files
              </button>
            </div>
            <!-- Recall Panel -->
            <div class="palace-panel active" id="palace-recall-panel">
              <div class="palace-recall-input-area">
                <textarea class="palace-recall-input" id="palace-recall-input" placeholder="Search by meaning… e.g. 'How does authentication work?'" rows="2"></textarea>
                <button class="btn btn-primary btn-sm" id="palace-recall-btn">Recall</button>
              </div>
              <div class="palace-recall-results" id="palace-recall-results">
                <div class="empty-state" id="palace-recall-empty">
                  <div class="empty-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg></div>
                  <div class="empty-title">Semantic search</div>
                  <div class="empty-subtitle">Search your agent's memories by meaning — not just keywords</div>
                </div>
              </div>
            </div>
            <!-- Graph Panel -->
            <div class="palace-panel" id="palace-graph-panel">
              <div class="palace-graph-container" id="palace-graph-canvas">
                <div class="empty-state" id="palace-graph-empty">
                  <div class="empty-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><circle cx="6" cy="6" r="3"/><circle cx="18" cy="18" r="3"/><circle cx="18" cy="6" r="3"/><line x1="8.5" y1="7.5" x2="15.5" y2="16.5"/></svg></div>
                  <div class="empty-title">Knowledge graph</div>
                  <div class="empty-subtitle">Visual map of how your agent's memories connect to each other</div>
                </div>
                <canvas id="palace-graph-render" width="800" height="600" style="display:none"></canvas>
              </div>
            </div>
            <!-- Remember Panel -->
            <div class="palace-panel" id="palace-remember-panel">
              <div class="palace-remember-form">
                <div class="form-group">
                  <label class="form-label">Category</label>
                  <select class="form-input" id="palace-remember-type">
                    <option value="other">Other</option>
                    <option value="fact">Fact</option>
                    <option value="preference">Preference</option>
                    <option value="decision">Decision</option>
                    <option value="procedure">Procedure</option>
                    <option value="concept">Concept</option>
                    <option value="code">Code</option>
                    <option value="person">Person</option>
                    <option value="project">Project</option>
                  </select>
                </div>
                <div class="form-group">
                  <label class="form-label">Content</label>
                  <textarea class="form-input" id="palace-remember-content" rows="5" placeholder="What should the agent remember?"></textarea>
                </div>
                <div class="form-group">
                  <label class="form-label">Importance (1–10)</label>
                  <select class="form-input" id="palace-remember-importance">
                    <option value="3">3 – Low</option>
                    <option value="5" selected>5 – Normal</option>
                    <option value="7">7 – High</option>
                    <option value="10">10 – Critical</option>
                  </select>
                </div>
                <button class="btn btn-primary" id="palace-remember-save" style="align-self:flex-start">
                  <svg class="icon-sm" viewBox="0 0 24 24" style="margin-right:4px"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
                  Store Memory
                </button>
              </div>
            </div>
            <!-- Files Panel (legacy agent files) -->
            <div class="palace-panel" id="palace-files-panel">
              <div class="memory-editor-panel" style="flex:1;display:flex;flex-direction:column">
                <div class="memory-editor" id="memory-editor" style="display:none">
                  <div class="memory-editor-header">
                    <span class="memory-editor-path" id="memory-editor-path"></span>
                    <div style="display:flex;gap:6px">
                      <button class="btn btn-ghost btn-sm" id="memory-editor-close">Close</button>
                      <button class="btn btn-primary btn-sm" id="memory-editor-save">Save</button>
                    </div>
                  </div>
                  <textarea class="memory-editor-content" id="memory-editor-content"></textarea>
                </div>
                <div class="empty-state" id="memory-empty">
                  <div class="empty-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/></svg></div>
                  <div class="empty-title">Agent files</div>
                  <div class="empty-subtitle">Raw filesystem used by your agent for persistent storage</div>
                </div>
              </div>
            </div>
          </div>
          <div class="view-loading" id="memory-loading" style="display:none">Loading memory…</div>
        </div>

        <!-- ═══ Skills View — Plugin Manager ═══ -->
        <div class="view list-view" id="skills-view">
          <div class="view-header">
            <h1 class="view-title">Skills</h1>
            <div style="display:flex;gap:6px">
              <button class="btn btn-ghost btn-sm" id="refresh-skills-btn">
                <svg class="icon-sm" viewBox="0 0 24 24"><polyline points="23 4 23 10 17 10"/><polyline points="1 20 1 14 7 14"/><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/></svg>
                Refresh
              </button>
              <button class="btn btn-primary btn-sm" id="skills-browse-bins">
                <svg class="icon-sm" viewBox="0 0 24 24"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>
                Browse &amp; Install
              </button>
            </div>
          </div>
          <!-- Status toast -->
          <div class="skills-toast" id="skills-toast" style="display:none"></div>
          <div class="skills-sections">
            <div class="skills-section" id="skills-installed-section">
              <div class="skills-section-label">Installed</div>
              <div class="skills-grid" id="skills-installed-list"></div>
            </div>
            <div class="skills-section" id="skills-available-section" style="display:none">
              <div class="skills-section-label">Available to Install</div>
              <div class="skills-grid" id="skills-available-list"></div>
            </div>
          </div>
          <div class="empty-state" id="skills-empty">
            <div class="empty-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"/></svg></div>
            <div class="empty-title">No skills found</div>
            <div class="empty-subtitle">Install skills to give your agent new abilities</div>
          </div>
          <div class="view-loading" id="skills-loading" style="display:none">Loading skills…</div>
          <!-- Bins modal -->
          <div class="modal-backdrop" id="bins-modal-backdrop" style="display:none">
            <div class="modal" style="max-width:520px">
              <div class="modal-header">
                <h2 class="modal-title">Browse Skill Bins</h2>
                <button class="btn btn-ghost btn-sm" id="bins-modal-close">✕</button>
              </div>
              <div class="modal-body">
                <p style="color:var(--text-secondary);font-size:0.85rem;margin-bottom:12px">Select a skill bin to install, or enter a custom skill name below.</p>
                <div id="bins-list" class="bins-list"></div>
                <div id="bins-loading" style="display:none;padding:1rem;color:var(--text-secondary)">Loading bins…</div>
                <div id="bins-empty" style="display:none;padding:1rem;color:var(--text-secondary)">No additional bins found. You can install by name below.</div>
                <div class="bins-custom" style="margin-top:16px;border-top:1px solid var(--border);padding-top:12px">
                  <label style="font-size:0.8rem;font-weight:600;color:var(--text-secondary)">Install by name</label>
                  <div style="display:flex;gap:8px;margin-top:6px">
                    <input type="text" id="bins-custom-name" class="form-input" placeholder="e.g. memory-palace" style="flex:1">
                    <button class="btn btn-primary btn-sm" id="bins-custom-install">Install</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- ═══ Foundry View — Models & Modes ═══ -->
        <div class="view list-view" id="foundry-view">
          <div class="view-header">
            <h1 class="view-title">Foundry</h1>
            <button class="btn btn-ghost btn-sm" id="refresh-models-btn">
              <svg class="icon-sm" viewBox="0 0 24 24"><polyline points="23 4 23 10 17 10"/><polyline points="1 20 1 14 7 14"/><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/></svg>
              Refresh
            </button>
          </div>
          <div class="foundry-tabs">
            <button class="foundry-tab active" data-foundry-tab="models">Models</button>
            <button class="foundry-tab" data-foundry-tab="modes">Agent Modes</button>
          </div>
          <!-- Models Tab -->
          <div class="foundry-panel" id="foundry-models-panel">
            <div class="models-grid" id="models-list"></div>
            <div class="empty-state" id="models-empty">
              <div class="empty-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/></svg></div>
              <div class="empty-title">No models available</div>
              <div class="empty-subtitle">Connect to the gateway to see available models</div>
            </div>
            <div class="view-loading" id="models-loading" style="display:none">Loading models…</div>
          </div>
          <!-- Agent Modes Tab -->
          <div class="foundry-panel" id="foundry-modes-panel" style="display:none">
            <div class="modes-header">
              <p class="modes-description">Agent modes are named configurations — each with its own model, system prompt, and skill set.</p>
              <button class="btn btn-primary btn-sm" id="modes-add-btn">
                <svg class="icon-sm" viewBox="0 0 24 24"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
                New Mode
              </button>
            </div>
            <div class="modes-list" id="modes-list"></div>
            <div class="empty-state" id="modes-empty" style="display:none">
              <div class="empty-title">No modes yet</div>
              <div class="empty-subtitle">Create modes to quickly switch your agent's behavior</div>
            </div>
          </div>
          <!-- Mode Editor Modal -->
          <div class="modal-overlay" id="mode-modal" style="display:none">
            <div class="modal-card modal-lg">
              <div class="modal-header">
                <h2 class="modal-title" id="mode-modal-title">New Agent Mode</h2>
                <button class="btn-icon" id="mode-modal-close">✕</button>
              </div>
              <div class="modal-body">
                <div class="form-row">
                  <div class="form-group" style="flex:0 0 60px">
                    <label class="form-label">Icon</label>
                    <input type="text" class="form-input form-input-icon" id="mode-form-icon" value="🤖" maxlength="2" />
                  </div>
                  <div class="form-group" style="flex:1">
                    <label class="form-label">Name</label>
                    <input type="text" class="form-input" id="mode-form-name" placeholder="Code Review" />
                  </div>
                  <div class="form-group" style="flex:0 0 100px">
                    <label class="form-label">Color</label>
                    <input type="color" class="form-input form-input-color" id="mode-form-color" value="#0073EA" />
                  </div>
                </div>
                <div class="form-group">
                  <label class="form-label">Model (leave blank for default)</label>
                  <select class="form-input" id="mode-form-model">
                    <option value="">Default model</option>
                  </select>
                </div>
                <div class="form-group">
                  <label class="form-label">System Prompt</label>
                  <textarea class="form-input" id="mode-form-prompt" rows="4" placeholder="You are a careful code reviewer..."></textarea>
                </div>
                <div class="form-row">
                  <div class="form-group" style="flex:1">
                    <label class="form-label">Thinking Level</label>
                    <select class="form-input" id="mode-form-thinking">
                      <option value="none">None</option>
                      <option value="low">Low</option>
                      <option value="normal" selected>Normal</option>
                      <option value="high">High</option>
                    </select>
                  </div>
                  <div class="form-group" style="flex:1">
                    <label class="form-label">Temperature</label>
                    <input type="range" class="form-range" id="mode-form-temp" min="0" max="2" step="0.1" value="1" />
                    <span class="form-range-value" id="mode-form-temp-value">1.0</span>
                  </div>
                </div>
              </div>
              <div class="modal-footer">
                <button class="btn btn-secondary" id="mode-modal-cancel">Cancel</button>
                <button class="btn btn-error btn-sm" id="mode-modal-delete" style="display:none">Delete</button>
                <button class="btn btn-primary" id="mode-modal-save">Save Mode</button>
              </div>
            </div>
          </div>
        </div>

        <!-- ═══ Settings View ═══ -->
        <div class="view settings-view" id="settings-view">
          <h1 class="view-title" style="margin-bottom: 24px;">Settings</h1>
          
          <div class="settings-section">
            <h2 class="settings-section-title">Gateway Connection</h2>
            <div class="form-group">
              <label class="form-label">URL</label>
              <input type="text" class="form-input" id="settings-gateway-url" />
            </div>
            <div class="form-group">
              <label class="form-label">Token</label>
              <input type="password" class="form-input" id="settings-gateway-token" />
            </div>
            <button class="btn btn-primary" id="settings-save-gateway" style="width: auto;">Save Gateway Settings</button>
          </div>

          <div class="settings-section" id="settings-config-section" style="display:none">
            <h2 class="settings-section-title">OpenClaw Configuration</h2>
            <textarea class="form-input" id="settings-config-editor" rows="12" style="font-family:var(--font-mono);font-size:12px;line-height:1.5;resize:vertical"></textarea>
            <div style="display:flex;gap:8px;margin-top:12px">
              <button class="btn btn-primary" id="settings-save-config" style="width:auto">Save Config</button>
              <button class="btn btn-secondary" id="settings-reload-config" style="width:auto">Reload</button>
            </div>
          </div>
          
          <div class="settings-section">
            <h2 class="settings-section-title">About</h2>
            <p style="color: var(--text-secondary); font-size: 13px; line-height: 1.8;">
              <strong>Paw</strong> v0.1.0<br>
              Built on <a href="https://github.com/openclaw/openclaw" target="_blank" style="color: var(--accent);">OpenClaw</a><br>
              <span id="settings-gateway-version" style="color:var(--text-muted)"></span><br>
              <a href="https://github.com/elisplash/paw" target="_blank" style="color: var(--text-muted);">View source on GitHub</a>
            </p>
          </div>
        </div>
      </main>
    </div>

    <script type="module" src="/src/main.ts"></script>
  </body>
</html>
